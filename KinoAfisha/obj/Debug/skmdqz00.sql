DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'KinoAfisha.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '202111200506189_Init1'
BEGIN
    CREATE TABLE [dbo].[FilmCovers] (
        [Id] [int] NOT NULL IDENTITY,
        [Guid] [uniqueidentifier] NOT NULL,
        [Data] [varbinary](max) NOT NULL,
        [ContentType] [nvarchar](100),
        [DateChanged] [datetime],
        [FileName] [nvarchar](max),
        CONSTRAINT [PK_dbo.FilmCovers] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Films] (
        [Id] [int] NOT NULL IDENTITY,
        [NameFilm] [nvarchar](max) NOT NULL,
        [FilmYears] [int] NOT NULL,
        [FilmCover_Id] [int],
        CONSTRAINT [PK_dbo.Films] PRIMARY KEY ([Id])
    )
    CREATE INDEX [IX_FilmCover_Id] ON [dbo].[Films]([FilmCover_Id])
    CREATE TABLE [dbo].[Kinoes] (
        [Id] [int] NOT NULL IDENTITY,
        [NameId] [int] NOT NULL,
        [Price] [decimal](18, 2) NOT NULL,
        [NumberOfBilets] [int] NOT NULL,
        [Cinema] [int] NOT NULL,
        [NextArrivalDate] [datetime] NOT NULL,
        [CreateAt] [datetime] NOT NULL,
        [Film_Id] [int],
        CONSTRAINT [PK_dbo.Kinoes] PRIMARY KEY ([Id])
    )
    CREATE INDEX [IX_Film_Id] ON [dbo].[Kinoes]([Film_Id])
    ALTER TABLE [dbo].[Films] ADD CONSTRAINT [FK_dbo.Films_dbo.FilmCovers_FilmCover_Id] FOREIGN KEY ([FilmCover_Id]) REFERENCES [dbo].[FilmCovers] ([Id])
    ALTER TABLE [dbo].[Kinoes] ADD CONSTRAINT [FK_dbo.Kinoes_dbo.Films_Film_Id] FOREIGN KEY ([Film_Id]) REFERENCES [dbo].[Films] ([Id])
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202111200506189_Init1', N'KinoAfisha.Migrations.Configuration',  0x1F8B0800000000000400ED5A5B6FDB36147E1FB0FF20E8691B52CB4937A00BEC16A9930C469B0BE2A4D8F6123012ED10A52897A4321BC37ED91EF693F61776A82B454A9664A7593614050A87978FE7CEC373F4F79F7F8DDEAC42EA3C602E48C4C6EEFE60E83A98F95140D862ECC672FEE295FBE6F5D75F8D4E8270E57CC8D7BD54EB60271363F75ECAE5A1E709FF1E87480C42E2F348447339F0A3D04341E41D0C873F7AFBFB1E060817B01C6774153349429CFC017F4E22E6E3A58C113D8B024C45360E33B304D5394721164BE4E3B1FB8EB0E8684EC43D1AA48B5DE788120484CC309DBB0E622C92480299873702CF248FD862B6840144AFD74B0CEBE6880A9C917F582EEFCAC9F04071E2951B73283F16320A7B02EEBFCC44E399DBB712B05B880E84770242966BC57522C0B17B4A68388940DBAE639E7638A15CADAC11F0A0D8B6E794937B853580D1A87F7BCE24A632E678CC702C39A27BCE657C4789FF0EAFAFA38F988D594CA94E20900873950118BAE4D11273B9BEC2F38CEC69E03A5E759F676E2CB6697B527EA64CBE3C709D73381CDD515CE85FE37D26238E7FC20C7324717089A4C49C290C9C48D03ADD38EBA79814A7A5BFADC336031C23897280B784210E479EA1D57BCC16F27EECC24FD739252B1CE423196ACF63C0CD2470A4CEC94F03FF004FAF9CB63F1CD69F76C3080406D82479DC85253CB9476C810BD1A8A16BF0FAB6AD606E58FDDA4063A34436D038F24A7F68F592FE0EF2C5376ACF52FFA702DD59993DAD5D9DFA0B465C1447C3FD30D046DBF0CED103592442A841CEC2E815A6C90A714F96DA09B7DA92531E855711CDF69533B7B328E6BEB2F2A876FA1AF105965BDAB0B2C57E36AC46BED870A30DB79FB719E39213BF8868C7D82721A2AE73C9E157967ABD729D998F14607FF4F338BCC3FC62FE1642A714BB513A210CF28C8AD3E4437DA9C22B79C439794054C57EFB1EE84B19C7B0F548F607DAE8CAB55EAC1CE1369D2D1DB818B47CB79CE9E7B671685C3C596C9A8A538A1665B2DAF7364A601EC39D21080798D335046DDDA8AAE23DC3CAFC322E7EC53CCAB8F880680C23FB963E2A1B6664555D7FB079FDF56FE0B6EBEA9697AD47488C5975CFF79BF79C90C5BDBDE9075BB3A90E37E835779F5D949A62FC3B1A3D45FE474CBBAAF31D47829175576DDE082249931EEBC57B2444E49344649AE768776EF5B81316389B2FE06A7A00C909C8912C4172E0B363F73B8B8146C4DCF90DC42C13A8C20E07837D935B8DB3CD0C97E1A989B29A58551295A607DDD9B4C35B8BCC7A30978646F5364160E35C6330B5F3E4D5B29235EE02EFFBCC634496239AF42BE4199676DE56C6635B4D96146C14D180D0BA59B155B7395588B1591358F5783DBDD416D527A066FED5EA0E05CD05AF5E678CDC3C0C8C7AC97A55063B30AFDDCA36DF0D3ED1E2151AA5997236706BFB419BB0363099670585E997652F2FAD7BE5F531AFA140363A43CB25C471AD60968D38B3B45A367931EB5F470A530CCF1735E5A482DAE22448AED1021BB3AADA10C0CB8F0BA9AA1B77485D789320B496D98EDEE041F979A62FDBDACA7D2BDFA17E9B51C5AA6D9938A52C4F81BD10528E84535C6BD9D6DEA4748928E235CF964944E390353D7D36ED4E8B4BFAFE74A43B425A69D211D291EE089522920E5499E84551592832082B27BAE395D5231DAC1CB591469EA168D3A23CCBA40C17376DB4B3058B47B0DE2D0DF7A96CB62C00E918E5682FCDE6CF2343B5F9F0B3D16D7A93ECA6DB2425E8AFDBFA6D9F4FB726423ED61D252B8DE820D9500F4A8C0248852263AE47ACCB1E6E9530978DF5A0CD2C83548833277B505794432AF415A34FEF0DD554C70E777ADEDA16D6F4B55DE297CAD26A02869D9BDA52E9E419254E9D752BC914C7F7A62CCB45B7A4AC373D70530724794C4E85AA9C150589AEFC9A496D6F63D0F2F8B610982DEB12E66A046D25EC3B68FF31146FBD3F9E9DCEB752B7F59431971491A778D2184F9751F68C68FF00C07A57A44B54313D7A20817A53CCD642E270A0160C669FE884128875E58233C4C81C0B9916C5DC83E1FE81F111C1F369E87B4204B46B57FFC97B2F4489B5B5BBD2B3CCAFB7D363463EC598245073A2EE821D5AEB0F88DF25DDF56F42B4FAF631DAE70C20FD7BC4ED067A89BD65B73C8021693437BA4099DDF39C448BE75D3BE4FF0F6333FBD38DE2DAAEE79CD0BC054879F36A38560174CA02BC1ABBBF271B0F9DE9CFB7FADE3DE78243B43B7486CE1F8FA478FBD6FD4F2BDE386297966EF0342DDD6DE8AC3674B7416868E4D685A8AD1AB95B0315094B7F2F791407D9A913A53D84FAF78A2CB42DDA58E09F982BF74114EE362139A46ED69310AC9CF96489A845B99DBA76717C25CC02D39C39C64BCC9447EB8C7539A7ED7556001B41A84D048FDA92EBA4A61655A78DA2DEADBCAD55FD145A6EA874D56BF9A9145CDF96B49B1A0DF5C07E2DC7F4090381F04E29378D42C5B4DD53AA3BA5B123D984DD0E9B9A5643AFB20E56CD601BF729FA9815216FEE3BD6F8A4595B7A069DCA4E84D58406B346F259FA91F6631D3C4DFBA61F5C5C904509A1CA0F0CFB151F2BD64CD93CCA7DDDA0285F625CFB675822C819D011875721F2254CFB5888E4C3D2EC439213C89E8229BB88E53296C0320EEF68E5433F1532369D9F345DAB348F2E96C957628FC102904954DA73C1DEC6840605DDA776DAD304A1625196102B5D4A95182FCAEF6ECE23D61128135F1142AF71B8A400262ED80C3DE06D68BB11F83D5E207F9DD75C9A41DA155115FBE898A00547A1C830CAFDF027D87010AE5EFF03BBFB18A1DA320000 , N'6.4.4')
END

